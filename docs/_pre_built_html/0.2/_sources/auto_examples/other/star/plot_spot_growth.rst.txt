
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/other/star/plot_spot_growth.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_other_star_plot_spot_growth.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_other_star_plot_spot_growth.py:


Plot the growth and decay of a spot
===================================

This example initializes a ``StarSpot`` object and plots it's
area as a function of time.

.. GENERATED FROM PYTHON SOURCE LINES 8-19

.. code-block:: default


    from astropy import units as u
    import numpy as np
    import matplotlib.pyplot as plt

    from VSPEC import variable_star_model as vsm
    from VSPEC.config import MSH

    SEED = 10
    rng = np.random.default_rng(SEED)








.. GENERATED FROM PYTHON SOURCE LINES 20-31

Initialize the spot
-------------------

First, let's initialize a ``StarSpot`` object.

We then add it to a ``SpotCollection`` object
because it will automatically delete the spot
when it decays.

Note: The most common unit of spot area is the
micro solar hemisphere (MSH).

.. GENERATED FROM PYTHON SOURCE LINES 31-51

.. code-block:: default


    spot = vsm.StarSpot(
        lat=0*u.deg,
        lon=0*u.deg,
        Amax=200*MSH,
        A0=10*MSH,
        Teff_umbra=2700*u.K,
        Teff_penumbra=2900*u.K,
        r_A=5.,
        growing=True,
        growth_rate=0.5/u.day,
        decay_rate=20*MSH/u.day,
        Nlat=500,
        Nlon=100
    )
    spotlist = vsm.SpotCollection(spot)

    print(
        f'The spot starts with an area of {spot.area_current}, and will grow to {spot.area_max}.')





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    The spot starts with an area of 10.0 msh, and will grow to 200.0 msh.




.. GENERATED FROM PYTHON SOURCE LINES 52-56

Step through time
-----------------

We now will plot the area of the spot as a function of time

.. GENERATED FROM PYTHON SOURCE LINES 56-73

.. code-block:: default


    dt = 8*u.hr
    total_time = 20*u.day
    n_steps = int(total_time/dt)
    time = np.arange(n_steps)*dt
    area = []
    area_unit = MSH
    for _ in range(n_steps):
        try:
            current_area = spotlist.spots[0].area_current.to_value(area_unit)
        except IndexError:  # the spot has decayed, so `spotlist.spots` is empty
            current_area = 0
        area.append(current_area)
        spotlist.age(dt)
    plt.plot(time, area)
    plt.xlabel(f'time ({time.unit})')
    plt.ylabel(f'Spot area {area_unit}')



.. image-sg:: /auto_examples/other/star/images/sphx_glr_plot_spot_growth_001.png
   :alt: plot spot growth
   :srcset: /auto_examples/other/star/images/sphx_glr_plot_spot_growth_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none


    Text(38.347222222222214, 0.5, 'Spot area msh')




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.176 seconds)


.. _sphx_glr_download_auto_examples_other_star_plot_spot_growth.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spot_growth.py <plot_spot_growth.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spot_growth.ipynb <plot_spot_growth.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
