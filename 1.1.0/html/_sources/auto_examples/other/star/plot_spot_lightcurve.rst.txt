
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/other/star/plot_spot_lightcurve.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_other_star_plot_spot_lightcurve.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_other_star_plot_spot_lightcurve.py:


Plot the lightcurve of a spotted star
=====================================

This example plots the lightcurve caused by a
spotted photosphere.

.. GENERATED FROM PYTHON SOURCE LINES 8-22

.. code-block:: Python

    from pathlib import Path
    from astropy import units as u
    import matplotlib.pyplot as plt
    import libpypsg

    from VSPEC import ObservationModel,PhaseAnalyzer

    try:
        CFG_PATH = Path(__file__).parent / 'spot_lightcurve.yaml'
    except NameError:
        CFG_PATH = 'spot_lightcurve.yaml'

    libpypsg.docker.set_url_and_run()








.. GENERATED FROM PYTHON SOURCE LINES 23-27

Initialize the VSPEC run
------------------------

We read in the config file and run the model.

.. GENERATED FROM PYTHON SOURCE LINES 27-32

.. code-block:: Python


    model = ObservationModel.from_yaml(CFG_PATH)
    model.build_planet()
    model.build_spectra()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/VSPEC/main.py:91: RuntimeWarning: Planet sampling is too low (4.00 d > 1.25 d)
      warnings.warn(msg, RuntimeWarning)
    Starting at phase 0.0 deg, observe for 40.0 d in 10 steps
    Phases = [  0. 144. 288.  72. 216.   0. 144. 288.  72. 216.   0.] deg
    Build Planet:   0%|          | 0/11 [00:00<?, ?it/s]    Build Planet:   9%|▉         | 1/11 [00:00<00:05,  1.95it/s]    Build Planet:  18%|█▊        | 2/11 [00:00<00:04,  2.05it/s]    Build Planet:  27%|██▋       | 3/11 [00:01<00:04,  1.93it/s]    Build Planet:  36%|███▋      | 4/11 [00:02<00:03,  2.00it/s]    Build Planet:  45%|████▌     | 5/11 [00:02<00:02,  2.08it/s]    Build Planet:  55%|█████▍    | 6/11 [00:02<00:02,  2.10it/s]    Build Planet:  64%|██████▎   | 7/11 [00:03<00:01,  2.14it/s]    Build Planet:  73%|███████▎  | 8/11 [00:03<00:01,  2.15it/s]    Build Planet:  82%|████████▏ | 9/11 [00:04<00:00,  2.14it/s]    Build Planet:  91%|█████████ | 10/11 [00:04<00:00,  2.16it/s]    Build Planet: 100%|██████████| 11/11 [00:05<00:00,  2.16it/s]    Build Planet: 100%|██████████| 11/11 [00:05<00:00,  2.11it/s]
    Generated 2 mature spots
    Creating interpolators:
    thermal    thermal, combined    thermal, combined, stellar    thermal, combined, stellar, photon noise    thermal, combined, stellar, photon noise, detector noise    thermal, combined, stellar, photon noise, detector noise, telescope noise    thermal, combined, stellar, photon noise, detector noise, telescope noise, background noise    thermal, combined, stellar, photon noise, detector noise, telescope noise, background noise, transit
    Finished!
    Build Spectra:   0%|          | 0/40 [00:00<?, ?it/s]
    Loading Spectra:   0%|          | 0/17 [00:00<?, ?it/s]PHOENIX grid for 2300 not found. Downloading...


    Downloading teff=2300:   0%|          | 0.00/33.8M [00:00<?, ?B/s]

    Downloading teff=2300:   0%|          | 4.10k/33.8M [00:00<47:06, 12.0kB/s]

    Downloading teff=2300:   0%|          | 28.7k/33.8M [00:00<08:40, 64.9kB/s]

    Downloading teff=2300:   0%|          | 111k/33.8M [00:00<02:13, 253kB/s]  

    Downloading teff=2300:   1%|          | 414k/33.8M [00:00<00:41, 807kB/s]

    Downloading teff=2300:   3%|▎         | 950k/33.8M [00:00<00:17, 1.87MB/s]

    Downloading teff=2300:   8%|▊         | 2.55M/33.8M [00:01<00:05, 5.42MB/s]

    Downloading teff=2300:  17%|█▋        | 5.73M/33.8M [00:01<00:02, 12.4MB/s]

    Downloading teff=2300:  28%|██▊       | 9.58M/33.8M [00:01<00:01, 19.5MB/s]

    Downloading teff=2300:  35%|███▌      | 11.8M/33.8M [00:01<00:01, 20.1MB/s]

    Downloading teff=2300:  42%|████▏     | 14.1M/33.8M [00:01<00:00, 20.6MB/s]

    Downloading teff=2300:  52%|█████▏    | 17.7M/33.8M [00:01<00:00, 24.5MB/s]

    Downloading teff=2300:  64%|██████▍   | 21.8M/33.8M [00:01<00:00, 28.3MB/s]

    Downloading teff=2300:  76%|███████▋  | 25.8M/33.8M [00:01<00:00, 31.6MB/s]

    Downloading teff=2300:  88%|████████▊ | 29.6M/33.8M [00:01<00:00, 33.3MB/s]

    Downloading teff=2300:  99%|█████████▉| 33.6M/33.8M [00:01<00:00, 35.0MB/s]    Downloading teff=2300: 100%|██████████| 33.8M/33.8M [00:01<00:00, 17.4MB/s]

    Loading Spectra:   6%|▌         | 1/17 [00:02<00:41,  2.62s/it]PHOENIX grid for 2400 not found. Downloading...


    Downloading teff=2400:   0%|          | 0.00/33.9M [00:00<?, ?B/s]

    Downloading teff=2400:   0%|          | 4.10k/33.9M [00:00<48:51, 11.6kB/s]

    Downloading teff=2400:   0%|          | 41.0k/33.9M [00:00<05:57, 94.7kB/s]

    Downloading teff=2400:   0%|          | 123k/33.9M [00:00<02:06, 268kB/s]  

    Downloading teff=2400:   1%|▏         | 438k/33.9M [00:00<00:39, 849kB/s]

    Downloading teff=2400:   3%|▎         | 1.04M/33.9M [00:00<00:15, 2.08MB/s]

    Downloading teff=2400:   6%|▋         | 2.14M/33.9M [00:01<00:07, 4.24MB/s]

    Downloading teff=2400:  16%|█▌        | 5.28M/33.9M [00:01<00:02, 11.4MB/s]

    Downloading teff=2400:  26%|██▋       | 8.96M/33.9M [00:01<00:01, 18.3MB/s]

    Downloading teff=2400:  37%|███▋      | 12.4M/33.9M [00:01<00:00, 22.1MB/s]

    Downloading teff=2400:  49%|████▊     | 16.4M/33.9M [00:01<00:00, 27.0MB/s]

    Downloading teff=2400:  61%|██████    | 20.5M/33.9M [00:01<00:00, 30.8MB/s]

    Downloading teff=2400:  72%|███████▏  | 24.5M/33.9M [00:01<00:00, 33.4MB/s]

    Downloading teff=2400:  84%|████████▍ | 28.6M/33.9M [00:01<00:00, 35.4MB/s]

    Downloading teff=2400:  95%|█████████▌| 32.3M/33.9M [00:01<00:00, 36.0MB/s]    Downloading teff=2400: 100%|██████████| 33.9M/33.9M [00:01<00:00, 17.7MB/s]

    Loading Spectra:  12%|█▏        | 2/17 [00:05<00:38,  2.59s/it]PHOENIX grid for 2500 not found. Downloading...


    Downloading teff=2500:   0%|          | 0.00/34.0M [00:00<?, ?B/s]

    Downloading teff=2500:   0%|          | 4.10k/34.0M [00:00<1:02:08, 9.11kB/s]

    Downloading teff=2500:   0%|          | 41.0k/34.0M [00:00<06:14, 90.7kB/s]  

    Downloading teff=2500:   0%|          | 111k/34.0M [00:00<02:43, 207kB/s]  

    Downloading teff=2500:   1%|          | 422k/34.0M [00:00<00:40, 834kB/s]

    Downloading teff=2500:   3%|▎         | 979k/34.0M [00:01<00:19, 1.71MB/s]

    Downloading teff=2500:   8%|▊         | 2.77M/34.0M [00:01<00:05, 5.43MB/s]

    Downloading teff=2500:  17%|█▋        | 5.72M/34.0M [00:01<00:02, 11.4MB/s]

    Downloading teff=2500:  27%|██▋       | 9.30M/34.0M [00:01<00:01, 17.7MB/s]

    Downloading teff=2500:  39%|███▊      | 13.1M/34.0M [00:01<00:00, 23.2MB/s]

    Downloading teff=2500:  48%|████▊     | 16.1M/34.0M [00:01<00:00, 25.3MB/s]

    Downloading teff=2500:  59%|█████▊    | 19.9M/34.0M [00:01<00:00, 28.8MB/s]

    Downloading teff=2500:  70%|███████   | 23.8M/34.0M [00:01<00:00, 31.7MB/s]

    Downloading teff=2500:  80%|████████  | 27.3M/34.0M [00:01<00:00, 32.5MB/s]

    Downloading teff=2500:  90%|█████████ | 30.7M/34.0M [00:01<00:00, 32.8MB/s]    Downloading teff=2500: 100%|██████████| 34.0M/34.0M [00:02<00:00, 16.7MB/s]

    Loading Spectra:  18%|█▊        | 3/17 [00:07<00:36,  2.64s/it]PHOENIX grid for 2600 not found. Downloading...


    Downloading teff=2600:   0%|          | 0.00/34.0M [00:00<?, ?B/s]

    Downloading teff=2600:   0%|          | 4.10k/34.0M [00:00<51:25, 11.0kB/s]

    Downloading teff=2600:   0%|          | 28.7k/34.0M [00:00<08:39, 65.3kB/s]

    Downloading teff=2600:   0%|          | 111k/34.0M [00:00<02:21, 240kB/s]  

    Downloading teff=2600:   1%|▏         | 426k/34.0M [00:00<00:40, 822kB/s]

    Downloading teff=2600:   3%|▎         | 1.06M/34.0M [00:00<00:15, 2.06MB/s]

    Downloading teff=2600:   9%|▉         | 2.98M/34.0M [00:01<00:04, 6.23MB/s]

    Downloading teff=2600:  18%|█▊        | 6.07M/34.0M [00:01<00:02, 12.6MB/s]

    Downloading teff=2600:  28%|██▊       | 9.66M/34.0M [00:01<00:01, 18.9MB/s]

    Downloading teff=2600:  39%|███▉      | 13.3M/34.0M [00:01<00:00, 23.7MB/s]

    Downloading teff=2600:  49%|████▉     | 16.7M/34.0M [00:01<00:00, 26.7MB/s]

    Downloading teff=2600:  60%|██████    | 20.5M/34.0M [00:01<00:00, 30.0MB/s]

    Downloading teff=2600:  71%|███████   | 24.2M/34.0M [00:01<00:00, 32.0MB/s]

    Downloading teff=2600:  81%|████████  | 27.5M/34.0M [00:01<00:00, 31.8MB/s]

    Downloading teff=2600:  91%|█████████▏| 31.0M/34.0M [00:01<00:00, 32.7MB/s]    Downloading teff=2600: 100%|██████████| 34.0M/34.0M [00:01<00:00, 18.2MB/s]

    Loading Spectra:  24%|██▎       | 4/17 [00:10<00:33,  2.59s/it]PHOENIX grid for 2700 not found. Downloading...


    Downloading teff=2700:   0%|          | 0.00/34.0M [00:00<?, ?B/s]

    Downloading teff=2700:   0%|          | 4.10k/34.0M [00:00<55:54, 10.1kB/s]

    Downloading teff=2700:   0%|          | 41.0k/34.0M [00:00<06:46, 83.5kB/s]

    Downloading teff=2700:   1%|          | 201k/34.0M [00:00<01:34, 357kB/s]  

    Downloading teff=2700:   3%|▎         | 889k/34.0M [00:00<00:22, 1.46MB/s]

    Downloading teff=2700:   8%|▊         | 2.57M/34.0M [00:01<00:06, 4.57MB/s]

    Downloading teff=2700:  15%|█▌        | 5.16M/34.0M [00:01<00:03, 9.36MB/s]

    Downloading teff=2700:  26%|██▌       | 8.70M/34.0M [00:01<00:01, 15.7MB/s]

    Downloading teff=2700:  35%|███▌      | 12.0M/34.0M [00:01<00:01, 20.2MB/s]

    Downloading teff=2700:  46%|████▌     | 15.6M/34.0M [00:01<00:00, 24.5MB/s]

    Downloading teff=2700:  56%|█████▋    | 19.1M/34.0M [00:01<00:00, 27.4MB/s]

    Downloading teff=2700:  68%|██████▊   | 23.0M/34.0M [00:01<00:00, 30.0MB/s]

    Downloading teff=2700:  78%|███████▊  | 26.6M/34.0M [00:01<00:00, 31.7MB/s]

    Downloading teff=2700:  90%|█████████ | 30.6M/34.0M [00:01<00:00, 33.9MB/s]    Downloading teff=2700: 100%|██████████| 34.0M/34.0M [00:01<00:00, 17.7MB/s]

    Loading Spectra:  29%|██▉       | 5/17 [00:12<00:31,  2.59s/it]PHOENIX grid for 2800 not found. Downloading...


    Downloading teff=2800:   0%|          | 0.00/33.9M [00:00<?, ?B/s]

    Downloading teff=2800:   0%|          | 4.10k/33.9M [00:00<49:34, 11.4kB/s]

    Downloading teff=2800:   0%|          | 32.8k/33.9M [00:00<07:04, 79.8kB/s]

    Downloading teff=2800:   0%|          | 119k/33.9M [00:00<02:14, 251kB/s]  

    Downloading teff=2800:   1%|          | 254k/33.9M [00:00<01:04, 525kB/s]

    Downloading teff=2800:   2%|▏         | 659k/33.9M [00:00<00:22, 1.45MB/s]

    Downloading teff=2800:   3%|▎         | 1.07M/33.9M [00:00<00:15, 2.16MB/s]

    Downloading teff=2800:   6%|▋         | 2.16M/33.9M [00:01<00:07, 4.52MB/s]

    Downloading teff=2800:  13%|█▎        | 4.35M/33.9M [00:01<00:03, 9.07MB/s]

    Downloading teff=2800:  20%|██        | 6.87M/33.9M [00:01<00:01, 13.5MB/s]

    Downloading teff=2800:  28%|██▊       | 9.53M/33.9M [00:01<00:01, 17.2MB/s]

    Downloading teff=2800:  36%|███▋      | 12.3M/33.9M [00:01<00:01, 20.3MB/s]

    Downloading teff=2800:  45%|████▍     | 15.2M/33.9M [00:01<00:00, 22.8MB/s]

    Downloading teff=2800:  54%|█████▎    | 18.2M/33.9M [00:01<00:00, 23.9MB/s]

    Downloading teff=2800:  62%|██████▏   | 21.1M/33.9M [00:01<00:00, 25.3MB/s]

    Downloading teff=2800:  71%|███████▏  | 24.2M/33.9M [00:01<00:00, 26.8MB/s]

    Downloading teff=2800:  81%|████████  | 27.5M/33.9M [00:02<00:00, 28.3MB/s]

    Downloading teff=2800:  92%|█████████▏| 31.2M/33.9M [00:02<00:00, 30.7MB/s]    Downloading teff=2800: 100%|██████████| 33.9M/33.9M [00:02<00:00, 15.8MB/s]

    Loading Spectra:  35%|███▌      | 6/17 [00:15<00:29,  2.65s/it]PHOENIX grid for 2900 not found. Downloading...


    Downloading teff=2900:   0%|          | 0.00/33.8M [00:00<?, ?B/s]

    Downloading teff=2900:   0%|          | 4.10k/33.8M [00:00<1:05:39, 8.59kB/s]

    Downloading teff=2900:   0%|          | 77.8k/33.8M [00:00<03:23, 166kB/s]   

    Downloading teff=2900:   1%|          | 258k/33.8M [00:00<01:10, 475kB/s] 

    Downloading teff=2900:   2%|▏         | 582k/33.8M [00:00<00:32, 1.03MB/s]

    Downloading teff=2900:   4%|▍         | 1.42M/33.8M [00:01<00:11, 2.74MB/s]

    Downloading teff=2900:   8%|▊         | 2.88M/33.8M [00:01<00:05, 5.69MB/s]

    Downloading teff=2900:  16%|█▌        | 5.49M/33.8M [00:01<00:02, 11.1MB/s]

    Downloading teff=2900:  24%|██▍       | 8.08M/33.8M [00:01<00:01, 15.1MB/s]

    Downloading teff=2900:  34%|███▍      | 11.6M/33.8M [00:01<00:01, 20.7MB/s]

    Downloading teff=2900:  46%|████▌     | 15.6M/33.8M [00:01<00:00, 25.4MB/s]

    Downloading teff=2900:  58%|█████▊    | 19.6M/33.8M [00:01<00:00, 28.9MB/s]

    Downloading teff=2900:  70%|██████▉   | 23.6M/33.8M [00:01<00:00, 31.7MB/s]

    Downloading teff=2900:  79%|███████▉  | 26.8M/33.8M [00:01<00:00, 31.7MB/s]

    Downloading teff=2900:  90%|████████▉ | 30.3M/33.8M [00:01<00:00, 32.5MB/s]    Downloading teff=2900: 100%|██████████| 33.8M/33.8M [00:01<00:00, 17.3MB/s]

    Loading Spectra:  41%|████      | 7/17 [00:18<00:26,  2.65s/it]PHOENIX grid for 3000 not found. Downloading...


    Downloading teff=3000:   0%|          | 0.00/33.8M [00:00<?, ?B/s]

    Downloading teff=3000:   0%|          | 4.10k/33.8M [00:00<59:15, 9.50kB/s]

    Downloading teff=3000:   0%|          | 45.1k/33.8M [00:00<05:12, 108kB/s] 

    Downloading teff=3000:   1%|          | 213k/33.8M [00:00<01:20, 419kB/s] 

    Downloading teff=3000:   2%|▏         | 520k/33.8M [00:00<00:32, 1.03MB/s]

    Downloading teff=3000:   5%|▌         | 1.80M/33.8M [00:01<00:09, 3.24MB/s]

    Downloading teff=3000:  12%|█▏        | 4.19M/33.8M [00:01<00:03, 7.91MB/s]

    Downloading teff=3000:  23%|██▎       | 7.73M/33.8M [00:01<00:01, 14.5MB/s]

    Downloading teff=3000:  34%|███▎      | 11.4M/33.8M [00:01<00:01, 20.2MB/s]

    Downloading teff=3000:  45%|████▌     | 15.3M/33.8M [00:01<00:00, 25.0MB/s]

    Downloading teff=3000:  56%|█████▌    | 18.9M/33.8M [00:01<00:00, 27.6MB/s]

    Downloading teff=3000:  66%|██████▌   | 22.2M/33.8M [00:01<00:00, 29.4MB/s]

    Downloading teff=3000:  75%|███████▌  | 25.4M/33.8M [00:01<00:00, 29.3MB/s]

    Downloading teff=3000:  86%|████████▋ | 29.2M/33.8M [00:01<00:00, 31.4MB/s]

    Downloading teff=3000:  97%|█████████▋| 32.8M/33.8M [00:01<00:00, 32.9MB/s]    Downloading teff=3000: 100%|██████████| 33.8M/33.8M [00:01<00:00, 17.4MB/s]

    Loading Spectra:  47%|████▋     | 8/17 [00:20<00:23,  2.63s/it]PHOENIX grid for 3100 not found. Downloading...


    Downloading teff=3100:   0%|          | 0.00/33.7M [00:00<?, ?B/s]

    Downloading teff=3100:   0%|          | 4.10k/33.7M [00:00<1:00:52, 9.23kB/s]

    Downloading teff=3100:   0%|          | 45.1k/33.7M [00:00<05:22, 104kB/s]   

    Downloading teff=3100:   1%|          | 193k/33.7M [00:00<01:21, 410kB/s] 

    Downloading teff=3100:   1%|▏         | 422k/33.7M [00:00<00:41, 797kB/s]

    Downloading teff=3100:   3%|▎         | 881k/33.7M [00:00<00:19, 1.69MB/s]

    Downloading teff=3100:   5%|▌         | 1.81M/33.7M [00:01<00:08, 3.64MB/s]

    Downloading teff=3100:  11%|█         | 3.68M/33.7M [00:01<00:03, 7.64MB/s]

    Downloading teff=3100:  22%|██▏       | 7.29M/33.7M [00:01<00:01, 15.5MB/s]

    Downloading teff=3100:  33%|███▎      | 11.1M/33.7M [00:01<00:01, 20.6MB/s]

    Downloading teff=3100:  44%|████▍     | 14.8M/33.7M [00:01<00:00, 25.0MB/s]

    Downloading teff=3100:  54%|█████▍    | 18.3M/33.7M [00:01<00:00, 27.4MB/s]

    Downloading teff=3100:  66%|██████▌   | 22.3M/33.7M [00:01<00:00, 30.5MB/s]

    Downloading teff=3100:  78%|███████▊  | 26.3M/33.7M [00:01<00:00, 32.9MB/s]

    Downloading teff=3100:  90%|█████████ | 30.4M/33.7M [00:01<00:00, 34.6MB/s]    Downloading teff=3100: 100%|██████████| 33.7M/33.7M [00:01<00:00, 17.7MB/s]

    Loading Spectra:  53%|█████▎    | 9/17 [00:23<00:20,  2.61s/it]
    Loading Spectra:  59%|█████▉    | 10/17 [00:23<00:13,  1.89s/it]
    Loading Spectra:  65%|██████▍   | 11/17 [00:24<00:08,  1.40s/it]
    Loading Spectra:  71%|███████   | 12/17 [00:24<00:05,  1.06s/it]PHOENIX grid for 3500 not found. Downloading...


    Downloading teff=3500:   0%|          | 0.00/33.4M [00:00<?, ?B/s]

    Downloading teff=3500:   0%|          | 4.10k/33.4M [00:00<53:45, 10.4kB/s]

    Downloading teff=3500:   0%|          | 12.3k/33.4M [00:00<19:04, 29.2kB/s]

    Downloading teff=3500:   0%|          | 94.2k/33.4M [00:00<02:23, 232kB/s] 

    Downloading teff=3500:   1%|          | 225k/33.4M [00:00<01:08, 483kB/s] 

    Downloading teff=3500:   2%|▏         | 512k/33.4M [00:00<00:31, 1.03MB/s]

    Downloading teff=3500:   5%|▌         | 1.77M/33.4M [00:00<00:08, 3.81MB/s]

    Downloading teff=3500:  12%|█▏        | 3.93M/33.4M [00:01<00:03, 7.79MB/s]

    Downloading teff=3500:  23%|██▎       | 7.61M/33.4M [00:01<00:01, 14.0MB/s]

    Downloading teff=3500:  34%|███▎      | 11.3M/33.4M [00:01<00:01, 19.7MB/s]

    Downloading teff=3500:  46%|████▌     | 15.3M/33.4M [00:01<00:00, 25.0MB/s]

    Downloading teff=3500:  58%|█████▊    | 19.3M/33.4M [00:01<00:00, 29.1MB/s]

    Downloading teff=3500:  69%|██████▉   | 23.2M/33.4M [00:01<00:00, 31.7MB/s]

    Downloading teff=3500:  81%|████████  | 27.1M/33.4M [00:01<00:00, 33.3MB/s]

    Downloading teff=3500:  92%|█████████▏| 30.6M/33.4M [00:01<00:00, 33.7MB/s]    Downloading teff=3500: 100%|██████████| 33.4M/33.4M [00:01<00:00, 17.7MB/s]

    Loading Spectra:  76%|███████▋  | 13/17 [00:27<00:06,  1.52s/it]PHOENIX grid for 3600 not found. Downloading...


    Downloading teff=3600:   0%|          | 0.00/33.3M [00:00<?, ?B/s]

    Downloading teff=3600:   0%|          | 4.10k/33.3M [00:00<46:00, 12.1kB/s]

    Downloading teff=3600:   0%|          | 41.0k/33.3M [00:00<05:56, 93.5kB/s]

    Downloading teff=3600:   0%|          | 98.3k/33.3M [00:00<02:36, 213kB/s] 

    Downloading teff=3600:   1%|▏         | 438k/33.3M [00:00<00:38, 858kB/s] 

    Downloading teff=3600:   3%|▎         | 958k/33.3M [00:00<00:17, 1.87MB/s]

    Downloading teff=3600:   7%|▋         | 2.36M/33.3M [00:01<00:06, 4.91MB/s]

    Downloading teff=3600:  16%|█▌        | 5.24M/33.3M [00:01<00:02, 11.2MB/s]

    Downloading teff=3600:  26%|██▋       | 8.83M/33.3M [00:01<00:01, 18.0MB/s]

    Downloading teff=3600:  38%|███▊      | 12.6M/33.3M [00:01<00:00, 23.5MB/s]

    Downloading teff=3600:  48%|████▊     | 16.2M/33.3M [00:01<00:00, 27.0MB/s]

    Downloading teff=3600:  60%|█████▉    | 19.9M/33.3M [00:01<00:00, 29.9MB/s]

    Downloading teff=3600:  70%|██████▉   | 23.3M/33.3M [00:01<00:00, 31.1MB/s]

    Downloading teff=3600:  79%|███████▉  | 26.5M/33.3M [00:01<00:00, 30.5MB/s]

    Downloading teff=3600:  89%|████████▉ | 29.6M/33.3M [00:01<00:00, 23.9MB/s]

    Downloading teff=3600:  99%|█████████▉| 33.1M/33.3M [00:02<00:00, 26.6MB/s]    Downloading teff=3600: 100%|██████████| 33.3M/33.3M [00:02<00:00, 16.5MB/s]

    Loading Spectra:  82%|████████▏ | 14/17 [00:29<00:05,  1.87s/it]PHOENIX grid for 3700 not found. Downloading...


    Downloading teff=3700:   0%|          | 0.00/33.3M [00:00<?, ?B/s]

    Downloading teff=3700:   0%|          | 4.10k/33.3M [00:00<51:56, 10.7kB/s]

    Downloading teff=3700:   0%|          | 49.2k/33.3M [00:00<04:52, 114kB/s] 

    Downloading teff=3700:   1%|          | 193k/33.3M [00:00<01:19, 417kB/s] 

    Downloading teff=3700:   2%|▏         | 528k/33.3M [00:00<00:32, 1.02MB/s]

    Downloading teff=3700:   5%|▍         | 1.65M/33.3M [00:00<00:09, 3.26MB/s]

    Downloading teff=3700:  13%|█▎        | 4.35M/33.3M [00:01<00:03, 7.98MB/s]

    Downloading teff=3700:  25%|██▍       | 8.22M/33.3M [00:01<00:01, 15.2MB/s]

    Downloading teff=3700:  36%|███▌      | 11.9M/33.3M [00:01<00:01, 20.5MB/s]

    Downloading teff=3700:  47%|████▋     | 15.7M/33.3M [00:01<00:00, 25.1MB/s]

    Downloading teff=3700:  59%|█████▊    | 19.5M/33.3M [00:01<00:00, 28.7MB/s]

    Downloading teff=3700:  70%|███████   | 23.5M/33.3M [00:01<00:00, 31.6MB/s]

    Downloading teff=3700:  81%|████████  | 27.0M/33.3M [00:01<00:00, 32.6MB/s]

    Downloading teff=3700:  92%|█████████▏| 30.7M/33.3M [00:01<00:00, 33.9MB/s]    Downloading teff=3700: 100%|██████████| 33.3M/33.3M [00:01<00:00, 18.1MB/s]

    Loading Spectra:  88%|████████▊ | 15/17 [00:32<00:04,  2.05s/it]PHOENIX grid for 3800 not found. Downloading...


    Downloading teff=3800:   0%|          | 0.00/33.2M [00:00<?, ?B/s]

    Downloading teff=3800:   0%|          | 4.10k/33.2M [00:00<54:34, 10.1kB/s]

    Downloading teff=3800:   0%|          | 41.0k/33.2M [00:00<06:01, 91.8kB/s]

    Downloading teff=3800:   0%|          | 143k/33.2M [00:00<01:42, 323kB/s]  

    Downloading teff=3800:   1%|          | 377k/33.2M [00:00<00:38, 850kB/s]

    Downloading teff=3800:   2%|▏         | 647k/33.2M [00:00<00:24, 1.35MB/s]

    Downloading teff=3800:   4%|▍         | 1.42M/33.2M [00:00<00:10, 3.14MB/s]

    Downloading teff=3800:   8%|▊         | 2.53M/33.2M [00:01<00:05, 5.40MB/s]

    Downloading teff=3800:  15%|█▍        | 4.92M/33.2M [00:01<00:02, 10.8MB/s]

    Downloading teff=3800:  23%|██▎       | 7.76M/33.2M [00:01<00:01, 15.9MB/s]

    Downloading teff=3800:  33%|███▎      | 10.8M/33.2M [00:01<00:01, 20.2MB/s]

    Downloading teff=3800:  44%|████▎     | 14.5M/33.2M [00:01<00:00, 24.8MB/s]

    Downloading teff=3800:  53%|█████▎    | 17.5M/33.2M [00:01<00:00, 26.1MB/s]

    Downloading teff=3800:  65%|██████▍   | 21.5M/33.2M [00:01<00:00, 29.8MB/s]

    Downloading teff=3800:  77%|███████▋  | 25.5M/33.2M [00:01<00:00, 32.2MB/s]

    Downloading teff=3800:  88%|████████▊ | 29.2M/33.2M [00:01<00:00, 33.0MB/s]    Downloading teff=3800: 100%|██████████| 33.2M/33.2M [00:01<00:00, 17.4MB/s]

    Loading Spectra:  94%|█████████▍| 16/17 [00:34<00:02,  2.20s/it]PHOENIX grid for 3900 not found. Downloading...


    Downloading teff=3900:   0%|          | 0.00/33.2M [00:00<?, ?B/s]

    Downloading teff=3900:   0%|          | 4.10k/33.2M [00:00<45:34, 12.1kB/s]

    Downloading teff=3900:   0%|          | 36.9k/33.2M [00:00<06:31, 84.6kB/s]

    Downloading teff=3900:   0%|          | 115k/33.2M [00:00<02:07, 260kB/s]  

    Downloading teff=3900:   1%|▏         | 434k/33.2M [00:00<00:38, 847kB/s]

    Downloading teff=3900:   3%|▎         | 1.02M/33.2M [00:00<00:15, 2.04MB/s]

    Downloading teff=3900:   9%|▉         | 3.04M/33.2M [00:01<00:04, 6.62MB/s]

    Downloading teff=3900:  19%|█▉        | 6.23M/33.2M [00:01<00:02, 13.3MB/s]

    Downloading teff=3900:  28%|██▊       | 9.27M/33.2M [00:01<00:01, 18.0MB/s]

    Downloading teff=3900:  39%|███▉      | 12.9M/33.2M [00:01<00:00, 23.2MB/s]

    Downloading teff=3900:  49%|████▉     | 16.3M/33.2M [00:01<00:00, 26.2MB/s]

    Downloading teff=3900:  58%|█████▊    | 19.1M/33.2M [00:01<00:00, 24.8MB/s]

    Downloading teff=3900:  65%|██████▌   | 21.7M/33.2M [00:01<00:00, 15.8MB/s]

    Downloading teff=3900:  72%|███████▏  | 23.8M/33.2M [00:02<00:00, 13.5MB/s]

    Downloading teff=3900:  77%|███████▋  | 25.5M/33.2M [00:02<00:00, 11.4MB/s]

    Downloading teff=3900:  81%|████████▏ | 27.0M/33.2M [00:02<00:00, 11.8MB/s]

    Downloading teff=3900:  86%|████████▌ | 28.4M/33.2M [00:02<00:00, 10.2MB/s]

    Downloading teff=3900:  89%|████████▉ | 29.6M/33.2M [00:02<00:00, 10.3MB/s]

    Downloading teff=3900:  93%|█████████▎| 30.8M/33.2M [00:02<00:00, 10.2MB/s]

    Downloading teff=3900:  96%|█████████▌| 31.9M/33.2M [00:02<00:00, 9.92MB/s]

    Downloading teff=3900:  99%|█████████▉| 32.9M/33.2M [00:03<00:00, 9.71MB/s]    Downloading teff=3900: 100%|██████████| 33.2M/33.2M [00:03<00:00, 10.8MB/s]

    Loading Spectra: 100%|██████████| 17/17 [00:38<00:00,  2.72s/it]    Loading Spectra: 100%|██████████| 17/17 [00:38<00:00,  2.27s/it]
    Build Spectra:   2%|▎         | 1/40 [00:39<25:49, 39.74s/it]    Build Spectra:   5%|▌         | 2/40 [00:40<10:44, 16.96s/it]    Build Spectra:   8%|▊         | 3/40 [00:41<05:57,  9.67s/it]    Build Spectra:  10%|█         | 4/40 [00:42<03:45,  6.25s/it]    Build Spectra:  12%|█▎        | 5/40 [00:43<02:32,  4.36s/it]    Build Spectra:  15%|█▌        | 6/40 [00:44<01:49,  3.22s/it]    Build Spectra:  18%|█▊        | 7/40 [00:45<01:22,  2.50s/it]    Build Spectra:  20%|██        | 8/40 [00:46<01:04,  2.02s/it]    Build Spectra:  22%|██▎       | 9/40 [00:47<00:52,  1.71s/it]    Build Spectra:  25%|██▌       | 10/40 [00:48<00:44,  1.49s/it]    Build Spectra:  28%|██▊       | 11/40 [00:49<00:38,  1.34s/it]    Build Spectra:  30%|███       | 12/40 [00:50<00:34,  1.24s/it]    Build Spectra:  32%|███▎      | 13/40 [00:51<00:31,  1.17s/it]    Build Spectra:  35%|███▌      | 14/40 [00:52<00:29,  1.12s/it]    Build Spectra:  38%|███▊      | 15/40 [00:53<00:27,  1.09s/it]    Build Spectra:  40%|████      | 16/40 [00:54<00:25,  1.06s/it]    Build Spectra:  42%|████▎     | 17/40 [00:55<00:24,  1.05s/it]    Build Spectra:  45%|████▌     | 18/40 [00:56<00:22,  1.04s/it]    Build Spectra:  48%|████▊     | 19/40 [00:57<00:21,  1.03s/it]    Build Spectra:  50%|█████     | 20/40 [00:58<00:20,  1.02s/it]    Build Spectra:  52%|█████▎    | 21/40 [00:59<00:19,  1.02s/it]    Build Spectra:  55%|█████▌    | 22/40 [01:00<00:18,  1.02s/it]    Build Spectra:  57%|█████▊    | 23/40 [01:01<00:17,  1.02s/it]    Build Spectra:  60%|██████    | 24/40 [01:02<00:16,  1.02s/it]    Build Spectra:  62%|██████▎   | 25/40 [01:03<00:15,  1.01s/it]    Build Spectra:  65%|██████▌   | 26/40 [01:04<00:14,  1.02s/it]    Build Spectra:  68%|██████▊   | 27/40 [01:05<00:13,  1.01s/it]    Build Spectra:  70%|███████   | 28/40 [01:06<00:12,  1.01s/it]    Build Spectra:  72%|███████▎  | 29/40 [01:07<00:11,  1.01s/it]    Build Spectra:  75%|███████▌  | 30/40 [01:08<00:10,  1.01s/it]    Build Spectra:  78%|███████▊  | 31/40 [01:09<00:09,  1.01s/it]    Build Spectra:  80%|████████  | 32/40 [01:11<00:08,  1.01s/it]    Build Spectra:  82%|████████▎ | 33/40 [01:12<00:07,  1.01s/it]    Build Spectra:  85%|████████▌ | 34/40 [01:13<00:06,  1.01s/it]    Build Spectra:  88%|████████▊ | 35/40 [01:14<00:05,  1.01s/it]    Build Spectra:  90%|█████████ | 36/40 [01:15<00:04,  1.01s/it]    Build Spectra:  92%|█████████▎| 37/40 [01:16<00:03,  1.01s/it]    Build Spectra:  95%|█████████▌| 38/40 [01:17<00:02,  1.01s/it]    Build Spectra:  98%|█████████▊| 39/40 [01:18<00:01,  1.01s/it]    Build Spectra: 100%|██████████| 40/40 [01:19<00:00,  1.01s/it]    Build Spectra: 100%|██████████| 40/40 [01:19<00:00,  1.98s/it]




.. GENERATED FROM PYTHON SOURCE LINES 33-38

Load in the data
----------------

We can use VSPEC to read in the synthetic
data we just created.

.. GENERATED FROM PYTHON SOURCE LINES 38-41

.. code-block:: Python


    data = PhaseAnalyzer(model.directories['all_model'])





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    /opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/VSPEC/analysis.py:116: RuntimeWarning: No Layer info, maybe globes or molecular signatures are off
      warnings.warn(




.. GENERATED FROM PYTHON SOURCE LINES 42-46

Get the lightcurve
------------------

We will look in a few different wavelengths.

.. GENERATED FROM PYTHON SOURCE LINES 46-59

.. code-block:: Python


    wl_pixels = [0,300,500,700]
    time = data.time.to(u.day)
    for i in wl_pixels:
        wl = data.wavelength[i]
        lc = data.lightcurve(
            source='star',
            pixel=i,
            normalize=0
        )
        plt.plot(time,lc,label=f'{wl:.1f}')
    plt.legend()
    plt.xlabel(f'time ({time.unit})')
    _=plt.ylabel('Flux (normalized)')


.. image-sg:: /auto_examples/other/star/images/sphx_glr_plot_spot_lightcurve_001.png
   :alt: plot spot lightcurve
   :srcset: /auto_examples/other/star/images/sphx_glr_plot_spot_lightcurve_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (1 minutes 28.934 seconds)


.. _sphx_glr_download_auto_examples_other_star_plot_spot_lightcurve.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_spot_lightcurve.ipynb <plot_spot_lightcurve.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_spot_lightcurve.py <plot_spot_lightcurve.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_spot_lightcurve.zip <plot_spot_lightcurve.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
