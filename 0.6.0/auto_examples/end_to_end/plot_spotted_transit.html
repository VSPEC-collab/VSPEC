
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Observe a transit of a spotted star. &#8212; VSPEC 0.6.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/table_fix.css?v=fdc28d34" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=f32b83b8" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="../../_static/documentation_options.js?v=8fa8b3e9"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/end_to_end/plot_spotted_transit';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.15.3';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://VSPEC-collab.github.io/VSPEC/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'latest';
        DOCUMENTATION_OPTIONS.show_version_warning_banner = false;
        </script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Other Examples" href="../other/index.html" />
    <link rel="prev" title="Observe a phase curve of a spotted star." href="plot_gj1214b_kempton23.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/vspec_logo.png" class="logo__image only-light" alt="VSPEC 0.6.0 documentation - Home"/>
    <script>document.write(`<img src="../../_static/vspec_logo.png" class="logo__image only-dark" alt="VSPEC 0.6.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
      <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button id="pst-version-switcher-button-2"
      type="button"
      class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle"
      data-bs-toggle="dropdown"
      aria-haspopup="listbox"
      aria-controls="pst-version-switcher-list-2"
      aria-label="Version switcher list"
    >
      Choose version  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div id="pst-version-switcher-list-2"
      class="version-switcher__menu dropdown-menu list-group-flush py-0"
      role="listbox" aria-labelledby="pst-version-switcher-button-2">
      <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../intro.html">
    Introduction
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../components.html">
    VSPEC API
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../inputs.html">
    Inputs
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../references.html">
    References
  </a>
</li>

            <li class="nav-item dropdown pst-header-nav-item">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class="nav-item  current active">
  <a class="nav-link dropdown-item nav-internal" href="index.html">
    End-to-End Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link dropdown-item nav-internal" href="../other/index.html">
    Other Examples
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../intro.html">
    Introduction
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../getting_started.html">
    Getting Started
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../components.html">
    VSPEC API
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../inputs.html">
    Inputs
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../../references.html">
    References
  </a>
</li>


<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    End-to-End Examples
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="../other/index.html">
    Other Examples
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">End-to-End Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Observe a...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-end-to-end-plot-spotted-transit-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="observe-a-transit-of-a-spotted-star">
<span id="sphx-glr-auto-examples-end-to-end-plot-spotted-transit-py"></span><h1>Observe a transit of a spotted star.<a class="headerlink" href="#observe-a-transit-of-a-spotted-star" title="Link to this heading">#</a></h1>
<p>This example demonstrates stellar contamination of a transit spectrum.</p>
<p>A transit can change the spot coverage of a star and produce a signal
that is difficult to distinguish from atmospheric absorption. We aim to simulate
data from <span id="id1">Moran <em>et al.</em> [<a class="reference internal" href="../../references.html#id13" title="Sarah E. Moran, Kevin B. Stevenson, David K. Sing, Ryan J. MacDonald, James Kirk, Jacob Lustig-Yaeger, Sarah Peacock, L. C. Mayorga, Katherine A. Bennett, Mercedes López-Morales, E. M. May, Zafar Rustamkulov, Jeff A. Valenti, Jéa I. Adams Redai, Munazza K. Alam, Natasha E. Batalha, Guangwei Fu, Junellie Gonzalez-Quiles, Alicia N. Highland, Ethan Kruse, Joshua D. Lothringer, Kevin N. Ortiz Ceballos, Kristin S. Sotzen, and Hannah R. Wakeford. High Tide or Riptide on the Cosmic Shoreline? A Water-rich Atmosphere or Stellar Contamination for the Warm Super-Earth GJ 486b from JWST Observations. \apjl , 948(1):L11, May 2023. arXiv:2305.00868, doi:10.3847/2041-8213/accb9c.">2023</a>]</span>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">pypsg</span>

<span class="kn">from</span> <span class="nn">VSPEC</span> <span class="kn">import</span> <span class="n">ObservationModel</span><span class="p">,</span><span class="n">PhaseAnalyzer</span>
<span class="kn">from</span> <span class="nn">VSPEC</span> <span class="kn">import</span> <span class="n">params</span>
<span class="kn">from</span> <span class="nn">VSPEC.config</span> <span class="kn">import</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MSH</span></a>

<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SEED</span></a> <span class="o">=</span> <span class="mi">10</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PRE_TRANSIT</span></a> <span class="o">=</span> <span class="mi">8</span>
<a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">IN_TRANSIT</span></a> <span class="o">=</span> <span class="mi">13</span>
<span class="n">pypsg</span><span class="o">.</span><span class="n">docker</span><span class="o">.</span><span class="n">set_url_and_run</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Saved settings to /home/ted/.pypsg/settings.json
Reloading settings...
</pre></div>
</div>
<section id="create-the-needed-configurations">
<h2>Create the needed configurations<a class="headerlink" href="#create-the-needed-configurations" title="Link to this heading">#</a></h2>
<p><span id="id2">Moran <em>et al.</em> [<a class="reference internal" href="../../references.html#id13" title="Sarah E. Moran, Kevin B. Stevenson, David K. Sing, Ryan J. MacDonald, James Kirk, Jacob Lustig-Yaeger, Sarah Peacock, L. C. Mayorga, Katherine A. Bennett, Mercedes López-Morales, E. M. May, Zafar Rustamkulov, Jeff A. Valenti, Jéa I. Adams Redai, Munazza K. Alam, Natasha E. Batalha, Guangwei Fu, Junellie Gonzalez-Quiles, Alicia N. Highland, Ethan Kruse, Joshua D. Lothringer, Kevin N. Ortiz Ceballos, Kristin S. Sotzen, and Hannah R. Wakeford. High Tide or Riptide on the Cosmic Shoreline? A Water-rich Atmosphere or Stellar Contamination for the Warm Super-Earth GJ 486b from JWST Observations. \apjl , 948(1):L11, May 2023. arXiv:2305.00868, doi:10.3847/2041-8213/accb9c.">2023</a>]</span> observed super-Earth GJ 486b with
JWST NIRSpec/G395H</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instrument</span>

<span class="n">inst</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">InstrumentParameters</span><span class="p">(</span>
    <span class="n">telescope</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">SingleDishParameters</span><span class="o">.</span><span class="n">jwst</span><span class="p">(),</span>
    <span class="n">bandpass</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">BandpassParameters</span><span class="p">(</span>
        <span class="n">wl_blue</span><span class="o">=</span><span class="mf">2.87</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">um</span></a><span class="p">,</span>
        <span class="n">wl_red</span><span class="o">=</span><span class="mf">5.14</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">um</span></a><span class="p">,</span>
        <span class="n">resolving_power</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
        <span class="n">wavelength_unit</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.PrefixUnit.html#astropy.units.PrefixUnit" title="astropy.units.PrefixUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">um</span></a><span class="p">,</span>
        <span class="n">flux_unit</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class"><span class="n">u</span><span class="o">.</span><span class="n">Unit</span></a><span class="p">(</span><span class="s1">&#39;W m-2 um-1&#39;</span><span class="p">)</span>
    <span class="p">),</span>
    <span class="n">detector</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">DetectorParameters</span><span class="p">(</span>
        <span class="n">beam_width</span><span class="o">=</span><span class="mi">5</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span></a><span class="p">,</span>
        <span class="n">integration_time</span><span class="o">=</span><span class="mf">0.5</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">s</span></a><span class="p">,</span>
        <span class="n">ccd</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">ccdParameters</span><span class="p">(</span>
            <span class="n">pixel_sampling</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
            <span class="n">read_noise</span><span class="o">=</span><span class="mf">16.8</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">electron</span></a><span class="p">,</span>
            <span class="n">dark_current</span><span class="o">=</span><span class="mf">0.005</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">electron</span></a><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">s</span></a><span class="p">,</span>
            <span class="n">throughput</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">emissivity</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
            <span class="n">temperature</span><span class="o">=</span><span class="mi">50</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">K</span></a>
        <span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Observation</span>

<span class="n">observation</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">ObservationParameters</span><span class="p">(</span>
    <span class="n">observation_time</span><span class="o">=</span><span class="mf">3.53</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">hr</span></a><span class="p">,</span>
    <span class="n">integration_time</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">min</span></a>
<span class="p">)</span>

<span class="c1"># PSG</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">psg_kwargs</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">gcm_binning</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">phase_binning</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">lmax</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">use_continuum_stellar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">continuum</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Rayleigh&#39;</span><span class="p">,</span> <span class="s1">&#39;Refraction&#39;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">psg_params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">psgParameters</span><span class="p">(</span>
    <span class="n">use_molecular_signatures</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">psg_kwargs</span></a>
<span class="p">)</span>
<span class="n">psg_no_atm</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">psgParameters</span><span class="p">(</span>
    <span class="n">use_molecular_signatures</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">psg_kwargs</span></a>
<span class="p">)</span>

<span class="c1"># Star and Planet</span>

<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_teff</span></a> <span class="o">=</span> <span class="mi">3343</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">K</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rad</span></a> <span class="o">=</span> <span class="mf">0.339</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">R_sun</span></a>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a_rstar</span></a> <span class="o">=</span> <span class="mf">11.229</span> <span class="c1"># Moran+23 Table 1</span>
<a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rp_rstar</span></a> <span class="o">=</span> <span class="mf">0.03709</span> <span class="c1"># Moran+23 Table 1</span>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_rad</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rad</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">rp_rstar</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_rad</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rad</span></a> <span class="o">*</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">a_rstar</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_period</span></a> <span class="o">=</span> <span class="mf">1.467119</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">day</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_rot_period</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_period</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rot_period</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">inf</span></a><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">s</span></a> <span class="c1"># assume the star does not change.</span>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_mass</span></a> <span class="o">=</span> <span class="mf">2.82</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">M_earth</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_mass</span></a> <span class="o">=</span> <span class="mf">0.323</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">M_sun</span></a>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inclination</span></a> <span class="o">=</span> <span class="mf">89.06</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_norm_factor</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;rock_quiet&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;rock_spotted&#39;</span><span class="p">:</span> <span class="mf">0.97</span><span class="p">,</span>
    <span class="s1">&#39;water_quiet&#39;</span><span class="p">:</span> <span class="mf">0.98</span><span class="p">,</span>
<span class="p">}</span> <span class="c1"># We will multiply the radius by these scalars rather than fit</span>
  <span class="c1"># later (because I have run this code before and know how much</span>
  <span class="c1"># each model is off by).</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Planet radius: </span><span class="si">{</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity.to_value" title="astropy.units.Quantity.to_value" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-method"><span class="n">planet_rad</span><span class="o">.</span><span class="n">to_value</span></a><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">R_earth</span></a><span class="p">)</span><span class="si">}</span><span class="s1"> R_earth&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Semimajor axis: </span><span class="si">{</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity.to_value" title="astropy.units.Quantity.to_value" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-method"><span class="n">orbit_rad</span><span class="o">.</span><span class="n">to_value</span></a><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">AU</span></a><span class="p">)</span><span class="si">}</span><span class="s1"> AU&#39;</span><span class="p">)</span>

<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">observation_angle</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">rad</span></a> <span class="o">*</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">observation</span><span class="o">.</span><span class="n">observation_time</span></a><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_period</span></a><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">)</span>
<a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">initial_phase</span></a> <span class="o">=</span> <span class="mi">180</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">observation_angle</span></a>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_kwargs</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GJ486b&#39;</span><span class="p">,</span>
    <span class="n">gravity</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">GravityParameters</span><span class="p">(</span><span class="s1">&#39;kg&#39;</span><span class="p">,</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_mass</span></a><span class="p">),</span>
    <span class="n">semimajor_axis</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_rad</span></a><span class="p">,</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_period</span></a><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_period</span></a><span class="p">,</span>
    <span class="n">rotation_period</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_rot_period</span></a><span class="p">,</span>
    <span class="n">eccentricity</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">obliquity</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">,</span>
    <span class="n">obliquity_direction</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">,</span>
    <span class="n">init_phase</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">initial_phase</span></a><span class="p">,</span>
    <span class="n">init_substellar_lon</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a>
<span class="p">)</span>

<span class="n">quiet_rock_planet</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">PlanetParameters</span><span class="p">(</span>
    <span class="n">radius</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_rad</span></a><span class="o">*</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_norm_factor</span></a><span class="p">[</span><span class="s1">&#39;rock_quiet&#39;</span><span class="p">],</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_kwargs</span></a>
<span class="p">)</span>
<span class="n">quiet_water_planet</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">PlanetParameters</span><span class="p">(</span>
    <span class="n">radius</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_rad</span></a><span class="o">*</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_norm_factor</span></a><span class="p">[</span><span class="s1">&#39;water_quiet&#39;</span><span class="p">],</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_kwargs</span></a>
<span class="p">)</span>
<span class="n">spotted_rock_planet</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">PlanetParameters</span><span class="p">(</span>
    <span class="n">radius</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_rad</span></a><span class="o">*</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_norm_factor</span></a><span class="p">[</span><span class="s1">&#39;rock_spotted&#39;</span><span class="p">],</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_kwargs</span></a>
<span class="p">)</span>


<span class="n">system_params</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">SystemParameters</span><span class="p">(</span>
    <span class="n">distance</span><span class="o">=</span><span class="mf">8.07</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">pc</span></a><span class="p">,</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inclination</span></a><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">inclination</span></a><span class="p">,</span>
    <span class="n">phase_of_periasteron</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a>
<span class="p">)</span>


<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_dict</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;teff&#39;</span><span class="p">:</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_teff</span></a><span class="p">,</span>
    <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rad</span></a>
<span class="p">}</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_dict</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;semimajor_axis&#39;</span><span class="p">:</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">orbit_rad</span></a><span class="p">}</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gcm_dict</span></a> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;nlayer&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;nlon&#39;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
    <span class="s1">&#39;nlat&#39;</span><span class="p">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="s1">&#39;epsilon&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s1">&#39;albedo&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span>
    <span class="s1">&#39;emissivity&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;lat_redistribution&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;gamma&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;psurf&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">bar</span></a><span class="p">,</span>
    <span class="s1">&#39;ptop&#39;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">bar</span></a><span class="p">,</span>
    <span class="s1">&#39;wind&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;U&#39;</span><span class="p">:</span> <span class="s1">&#39;0 m/s&#39;</span><span class="p">,</span><span class="s1">&#39;V&#39;</span><span class="p">:</span><span class="s1">&#39;0 m/s&#39;</span><span class="p">},</span>
    <span class="s1">&#39;molecules&#39;</span><span class="p">:{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}</span>
<span class="p">}</span>

<span class="c1"># Create two sets of GCM Parameters</span>

<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">h2o_atm</span></a> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;molecules&#39;</span><span class="p">:{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mf">0.99</span><span class="p">}}</span>
<span class="n">gcm_h2o</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">gcmParameters</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span>
    <span class="s1">&#39;star&#39;</span><span class="p">:</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_dict</span></a><span class="p">,</span>
    <span class="s1">&#39;planet&#39;</span><span class="p">:</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">planet_dict</span></a><span class="p">,</span>
    <span class="s1">&#39;gcm&#39;</span><span class="p">:{</span><span class="s1">&#39;vspec&#39;</span><span class="p">:</span><span class="nb">dict</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gcm_dict</span></a><span class="p">,</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">h2o_atm</span></a><span class="p">),</span><span class="s1">&#39;mean_molec_weight&#39;</span><span class="p">:</span><span class="mi">18</span><span class="p">}</span>
<span class="p">})</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_kwargs</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">psg_star_template</span><span class="o">=</span><span class="s1">&#39;M&#39;</span><span class="p">,</span>
    <span class="n">teff</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_teff</span></a><span class="p">,</span>
    <span class="n">mass</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_mass</span></a><span class="p">,</span>
    <span class="n">radius</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rad</span></a><span class="p">,</span>
    <span class="n">period</span><span class="o">=</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_rot_period</span></a><span class="p">,</span>
    <span class="n">misalignment</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">,</span>
    <span class="n">misalignment_dir</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">,</span>
    <span class="n">ld</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">LimbDarkeningParameters</span><span class="o">.</span><span class="n">lambertian</span><span class="p">(),</span>
    <span class="n">faculae</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">FaculaParameters</span><span class="o">.</span><span class="n">none</span><span class="p">(),</span>
    <span class="n">flares</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">FlareParameters</span><span class="o">.</span><span class="n">none</span><span class="p">(),</span>
    <span class="n">granulation</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">GranulationParameters</span><span class="o">.</span><span class="n">none</span><span class="p">(),</span>
    <span class="n">grid_params</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
    <span class="n">spectral_grid</span><span class="o">=</span><span class="s1">&#39;default&#39;</span>
<span class="p">)</span>
<span class="n">quiet_star</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">StarParameters</span><span class="p">(</span>
    <span class="n">spots</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">SpotParameters</span><span class="o">.</span><span class="n">none</span><span class="p">(),</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_kwargs</span></a>
<span class="p">)</span>
<span class="n">spotted_star</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">StarParameters</span><span class="p">(</span>
    <span class="n">spots</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">SpotParameters</span><span class="p">(</span>
        <span class="n">distribution</span><span class="o">=</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span>
        <span class="n">initial_coverage</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span>
        <span class="n">area_mean</span><span class="o">=</span><span class="mi">500</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MSH</span></a><span class="p">,</span>
        <span class="n">area_logsigma</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">teff_umbra</span><span class="o">=</span><span class="mi">2700</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">K</span></a><span class="p">,</span>
        <span class="n">teff_penumbra</span><span class="o">=</span><span class="mi">2700</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">K</span></a><span class="p">,</span>
        <span class="n">equillibrium_coverage</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">s</span></a><span class="p">,</span>
        <span class="n">growth_rate</span><span class="o">=</span><span class="mf">0.0</span><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">day</span></a><span class="p">,</span>
        <span class="n">decay_rate</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MSH</span></a><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">day</span></a><span class="p">,</span>
        <span class="n">initial_area</span><span class="o">=</span><span class="mi">10</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">MSH</span></a>
    <span class="p">),</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">star_kwargs</span></a>
<span class="p">)</span>

<span class="c1"># Set parameters for simulation</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_kwargs</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">teff_min</span><span class="o">=</span><span class="mi">2300</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">K</span></a><span class="p">,</span><span class="n">teff_max</span><span class="o">=</span><span class="mi">3400</span><span class="o">*</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">K</span></a><span class="p">,</span>
    <span class="n">seed</span> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SEED</span></a>
<span class="p">)</span>
<a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">internal_params_kwargs</span></a> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">system</span><span class="o">=</span><span class="n">system_params</span><span class="p">,</span>
    <span class="n">obs</span><span class="o">=</span><span class="n">observation</span><span class="p">,</span>
    <span class="n">gcm</span><span class="o">=</span><span class="n">gcm_h2o</span><span class="p">,</span>
    <span class="n">inst</span><span class="o">=</span><span class="n">inst</span>
<span class="p">)</span>

<span class="c1"># Make the three cases</span>

<span class="n">params_rock_quiet</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">InternalParameters</span><span class="p">(</span>
    <span class="n">header</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="s1">&#39;.vspec/rock_quiet&#39;</span><span class="p">),</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_kwargs</span></a><span class="p">),</span>
    <span class="n">star</span> <span class="o">=</span> <span class="n">quiet_star</span><span class="p">,</span>
    <span class="n">psg</span><span class="o">=</span><span class="n">psg_no_atm</span><span class="p">,</span>
    <span class="n">planet</span><span class="o">=</span><span class="n">quiet_rock_planet</span><span class="p">,</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">internal_params_kwargs</span></a>
<span class="p">)</span>
<span class="n">params_h2o_quiet</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">InternalParameters</span><span class="p">(</span>
    <span class="n">header</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="s1">&#39;.vspec/h2o_quiet&#39;</span><span class="p">),</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_kwargs</span></a><span class="p">),</span>
    <span class="n">star</span> <span class="o">=</span> <span class="n">quiet_star</span><span class="p">,</span>
    <span class="n">psg</span><span class="o">=</span><span class="n">psg_params</span><span class="p">,</span>
    <span class="n">planet</span><span class="o">=</span><span class="n">quiet_water_planet</span><span class="p">,</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">internal_params_kwargs</span></a>
<span class="p">)</span>

<span class="n">params_rock_spotted</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">InternalParameters</span><span class="p">(</span>
    <span class="n">header</span><span class="o">=</span><span class="n">params</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">data_path</span><span class="o">=</span><a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="s1">&#39;.vspec/rock_spotted&#39;</span><span class="p">),</span><span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">header_kwargs</span></a><span class="p">),</span>
    <span class="n">star</span> <span class="o">=</span> <span class="n">spotted_star</span><span class="p">,</span>
    <span class="n">psg</span><span class="o">=</span><span class="n">psg_no_atm</span><span class="p">,</span>
    <span class="n">planet</span><span class="o">=</span><span class="n">spotted_rock_planet</span><span class="p">,</span>
    <span class="o">**</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">internal_params_kwargs</span></a>
<span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Planet radius: 1.371472837835719 R_earth
Semimajor axis: 0.017702612840063636 AU
</pre></div>
</div>
</section>
<section id="run-vspec-for-the-simplest-case">
<h2>Run VSPEC for the simplest case<a class="headerlink" href="#run-vspec-for-the-simplest-case" title="Link to this heading">#</a></h2>
<p>We read in the config file and run the model.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model_rock_quiet</span> <span class="o">=</span> <span class="n">ObservationModel</span><span class="p">(</span><span class="n">params_rock_quiet</span><span class="p">)</span>
<span class="n">model_rock_quiet</span><span class="o">.</span><span class="n">build_planet</span><span class="p">()</span>
<span class="n">model_rock_quiet</span><span class="o">.</span><span class="n">build_spectra</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Starting at phase 161.9544290544939 deg, observe for 3.53 h in 26 steps
Phases = [161.95 163.32 164.68 166.04 167.41 168.77 170.13 171.5  172.86 174.22
 175.59 176.95 178.31 179.68 181.04 182.4  183.77 185.13 186.49 187.86
 189.22 190.58 191.95 193.31 194.67 196.03 197.4 ] deg

Build Planet:   0%|          | 0/26 [00:00&lt;?, ?it/s]
Build Planet:   4%|▍         | 1/26 [00:00&lt;00:02,  9.46it/s]
Build Planet:   8%|▊         | 2/26 [00:00&lt;00:02,  9.43it/s]
Build Planet:  15%|█▌        | 4/26 [00:00&lt;00:02,  9.46it/s]
Build Planet:  19%|█▉        | 5/26 [00:00&lt;00:02,  9.45it/s]
Build Planet:  23%|██▎       | 6/26 [00:00&lt;00:02,  9.19it/s]
Build Planet:  31%|███       | 8/26 [00:00&lt;00:01,  9.45it/s]
Build Planet:  35%|███▍      | 9/26 [00:00&lt;00:01,  9.19it/s]
Build Planet:  38%|███▊      | 10/26 [00:01&lt;00:01,  8.97it/s]
Build Planet:  42%|████▏     | 11/26 [00:01&lt;00:01,  9.08it/s]
Build Planet:  46%|████▌     | 12/26 [00:01&lt;00:01,  8.68it/s]
Build Planet:  50%|█████     | 13/26 [00:01&lt;00:01,  8.68it/s]
Build Planet:  54%|█████▍    | 14/26 [00:01&lt;00:01,  8.56it/s]
Build Planet:  58%|█████▊    | 15/26 [00:01&lt;00:01,  8.60it/s]
Build Planet:  62%|██████▏   | 16/26 [00:01&lt;00:01,  8.86it/s]
Build Planet:  65%|██████▌   | 17/26 [00:01&lt;00:01,  8.86it/s]
Build Planet:  69%|██████▉   | 18/26 [00:01&lt;00:00,  8.96it/s]
Build Planet:  73%|███████▎  | 19/26 [00:02&lt;00:00,  9.08it/s]
Build Planet:  77%|███████▋  | 20/26 [00:02&lt;00:00,  9.18it/s]
Build Planet:  81%|████████  | 21/26 [00:02&lt;00:00,  9.00it/s]
Build Planet:  88%|████████▊ | 23/26 [00:02&lt;00:00,  8.94it/s]
Build Planet:  92%|█████████▏| 24/26 [00:02&lt;00:00,  8.76it/s]
Build Planet:  96%|█████████▌| 25/26 [00:02&lt;00:00,  8.85it/s]
Build Planet: 100%|██████████| 26/26 [00:02&lt;00:00,  8.57it/s]
Build Planet: 27it [00:03,  8.76it/s]
Build Planet: 27it [00:03,  8.95it/s]

Build Spectra:   0%|          | 0/26 [00:00&lt;?, ?it/s]

Loading Spectra:   0%|          | 0/12 [00:00&lt;?, ?it/s]

Loading Spectra:   8%|▊         | 1/12 [00:00&lt;00:03,  3.43it/s]

Loading Spectra:  17%|█▋        | 2/12 [00:00&lt;00:02,  3.44it/s]

Loading Spectra:  25%|██▌       | 3/12 [00:00&lt;00:02,  3.44it/s]

Loading Spectra:  33%|███▎      | 4/12 [00:01&lt;00:02,  3.44it/s]

Loading Spectra:  42%|████▏     | 5/12 [00:01&lt;00:02,  3.44it/s]

Loading Spectra:  50%|█████     | 6/12 [00:01&lt;00:01,  3.45it/s]

Loading Spectra:  58%|█████▊    | 7/12 [00:02&lt;00:01,  3.45it/s]

Loading Spectra:  67%|██████▋   | 8/12 [00:02&lt;00:01,  3.45it/s]

Loading Spectra:  75%|███████▌  | 9/12 [00:02&lt;00:00,  3.46it/s]

Loading Spectra:  83%|████████▎ | 10/12 [00:02&lt;00:00,  3.46it/s]

Loading Spectra:  92%|█████████▏| 11/12 [00:03&lt;00:00,  3.46it/s]

Loading Spectra: 100%|██████████| 12/12 [00:03&lt;00:00,  3.46it/s]
Loading Spectra: 100%|██████████| 12/12 [00:03&lt;00:00,  3.45it/s]

Build Spectra:   4%|▍         | 1/26 [00:03&lt;01:31,  3.65s/it]
Build Spectra:   8%|▊         | 2/26 [00:03&lt;00:38,  1.60s/it]
Build Spectra:  12%|█▏        | 3/26 [00:03&lt;00:21,  1.06it/s]
Build Spectra:  15%|█▌        | 4/26 [00:04&lt;00:14,  1.56it/s]
Build Spectra:  19%|█▉        | 5/26 [00:04&lt;00:09,  2.13it/s]
Build Spectra:  23%|██▎       | 6/26 [00:04&lt;00:07,  2.72it/s]
Build Spectra:  27%|██▋       | 7/26 [00:04&lt;00:05,  3.30it/s]
Build Spectra:  31%|███       | 8/26 [00:04&lt;00:04,  3.84it/s]
Build Spectra:  35%|███▍      | 9/26 [00:04&lt;00:03,  4.32it/s]
Build Spectra:  38%|███▊      | 10/26 [00:05&lt;00:03,  4.71it/s]
Build Spectra:  42%|████▏     | 11/26 [00:05&lt;00:03,  4.54it/s]
Build Spectra:  46%|████▌     | 12/26 [00:05&lt;00:03,  4.43it/s]
Build Spectra:  50%|█████     | 13/26 [00:05&lt;00:02,  4.36it/s]
Build Spectra:  54%|█████▍    | 14/26 [00:06&lt;00:02,  4.31it/s]
Build Spectra:  58%|█████▊    | 15/26 [00:06&lt;00:02,  4.27it/s]
Build Spectra:  62%|██████▏   | 16/26 [00:06&lt;00:02,  4.24it/s]
Build Spectra:  65%|██████▌   | 17/26 [00:06&lt;00:02,  4.23it/s]
Build Spectra:  69%|██████▉   | 18/26 [00:07&lt;00:01,  4.28it/s]
Build Spectra:  73%|███████▎  | 19/26 [00:07&lt;00:01,  4.65it/s]
Build Spectra:  77%|███████▋  | 20/26 [00:07&lt;00:01,  4.94it/s]
Build Spectra:  81%|████████  | 21/26 [00:07&lt;00:00,  5.20it/s]
Build Spectra:  85%|████████▍ | 22/26 [00:07&lt;00:00,  5.38it/s]
Build Spectra:  88%|████████▊ | 23/26 [00:07&lt;00:00,  5.52it/s]
Build Spectra:  92%|█████████▏| 24/26 [00:08&lt;00:00,  5.63it/s]
Build Spectra:  96%|█████████▌| 25/26 [00:08&lt;00:00,  5.69it/s]
Build Spectra: 100%|██████████| 26/26 [00:08&lt;00:00,  5.75it/s]
Build Spectra: 100%|██████████| 26/26 [00:08&lt;00:00,  3.08it/s]
</pre></div>
</div>
</section>
<section id="load-in-the-data">
<h2>Load in the data<a class="headerlink" href="#load-in-the-data" title="Link to this heading">#</a></h2>
<p>We can use VSPEC to read in the synthetic
data we just created.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">data_rock_quiet</span> <span class="o">=</span> <span class="n">PhaseAnalyzer</span><span class="p">(</span><span class="n">model_rock_quiet</span><span class="o">.</span><span class="n">directories</span><span class="p">[</span><span class="s1">&#39;all_model&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/ted/github/VSPEC/VSPEC/analysis.py:115: RuntimeWarning: No Layer info, maybe globes or molecular signatures are off
  warnings.warn(
</pre></div>
</div>
</section>
<section id="plot-the-transit">
<h2>Plot the transit<a class="headerlink" href="#plot-the-transit" title="Link to this heading">#</a></h2>
<p>Lets plot the lightcurve of each channel.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_transit</span><span class="p">(</span><span class="n">data</span><span class="p">:</span><span class="n">PhaseAnalyzer</span><span class="p">,</span><span class="n">title</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="p">:</span><span class="nb">str</span><span class="p">):</span>
    <span class="n">time_from_mid_transit</span> <span class="o">=</span> <span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">time</span></a><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">time</span></a><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">time</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">hour</span></a><span class="p">)</span>

    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span><span class="n">axes</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
        <span class="n">time_from_mid_transit</span><span class="p">,</span>
        <span class="n">data</span><span class="o">.</span><span class="n">lightcurve</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="n">normalize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">noise</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
        <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a> <span class="o">=</span> <span class="s1">&#39;white light curve&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a>
    <span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time past mid-transit (hour)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Transit depth (ppm)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># standardize the epochs to use for analysis</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pre_transit</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PRE_TRANSIT</span></a>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_transit</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">IN_TRANSIT</span></a>

    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pre_transit</span></a><span class="p">)</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">occulted_spectrum</span></a> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_transit</span></a><span class="p">)</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lost_to_transit</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a><span class="o">-</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">occulted_spectrum</span></a>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a> <span class="o">=</span> <span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lost_to_transit</span></a><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a><span class="p">)</span><span class="o">.</span><span class="n">to_value</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.CompositeUnit.html#astropy.units.CompositeUnit" title="astropy.units.CompositeUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">dimensionless_unscaled</span></a><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">wavelength</span></a><span class="p">,</span> <span class="mf">1e6</span><span class="o">*</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a><span class="p">),</span><span class="n">c</span><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Wavelength (</span><span class="si">{</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity.unit" title="astropy.units.Quantity.unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">data</span><span class="o">.</span><span class="n">wavelength</span><span class="o">.</span><span class="n">unit</span></a><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Transit depth (ppm)&#39;</span><span class="p">)</span>
    <span class="n">ylo</span><span class="p">,</span><span class="n">yhi</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">yhi</span><span class="o">-</span><span class="n">ylo</span> <span class="o">&lt;</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="n">mean</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">ylo</span><span class="o">+</span><span class="n">yhi</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">mean</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="n">mean</span><span class="o">+</span><span class="mf">0.25</span><span class="p">)</span>

    <span class="k">return</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a>

<span class="n">plot_transit</span><span class="p">(</span><span class="n">data_rock_quiet</span><span class="p">,</span><span class="s1">&#39;Spotless Star and Bare Rock&#39;</span><span class="p">,</span><span class="s1">&#39;xkcd:lavender&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_spotted_transit_001.png" srcset="../../_images/sphx_glr_plot_spotted_transit_001.png" alt="Spotless Star and Bare Rock" class = "sphx-glr-single-img"/></section>
<section id="run-the-other-models">
<h2>Run the other models<a class="headerlink" href="#run-the-other-models" title="Link to this heading">#</a></h2>
<p>Let’s do the same analysis for the other cases.</p>
<section id="spotless-star-h2o-planet">
<h3>Spotless Star, H2O Planet<a class="headerlink" href="#spotless-star-h2o-planet" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model_h2o_quiet</span> <span class="o">=</span> <span class="n">ObservationModel</span><span class="p">(</span><span class="n">params_h2o_quiet</span><span class="p">)</span>
<span class="n">model_h2o_quiet</span><span class="o">.</span><span class="n">build_planet</span><span class="p">()</span>
<span class="n">model_h2o_quiet</span><span class="o">.</span><span class="n">build_spectra</span><span class="p">()</span>

<span class="n">data_h2o_quiet</span> <span class="o">=</span> <span class="n">PhaseAnalyzer</span><span class="p">(</span><span class="n">model_h2o_quiet</span><span class="o">.</span><span class="n">directories</span><span class="p">[</span><span class="s1">&#39;all_model&#39;</span><span class="p">])</span>

<span class="n">plot_transit</span><span class="p">(</span><span class="n">data_h2o_quiet</span><span class="p">,</span><span class="s1">&#39;Spotless Star and 1 bar H2O Atmosphere&#39;</span><span class="p">,</span><span class="s1">&#39;xkcd:azure&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_spotted_transit_002.png" srcset="../../_images/sphx_glr_plot_spotted_transit_002.png" alt="Spotless Star and 1 bar H2O Atmosphere" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Starting at phase 161.9544290544939 deg, observe for 3.53 h in 26 steps
Phases = [161.95 163.32 164.68 166.04 167.41 168.77 170.13 171.5  172.86 174.22
 175.59 176.95 178.31 179.68 181.04 182.4  183.77 185.13 186.49 187.86
 189.22 190.58 191.95 193.31 194.67 196.03 197.4 ] deg

Build Planet:   0%|          | 0/26 [00:00&lt;?, ?it/s]
Build Planet:   4%|▍         | 1/26 [00:00&lt;00:04,  5.11it/s]
Build Planet:   8%|▊         | 2/26 [00:00&lt;00:04,  5.90it/s]
Build Planet:  12%|█▏        | 3/26 [00:00&lt;00:03,  5.97it/s]
Build Planet:  15%|█▌        | 4/26 [00:00&lt;00:03,  6.07it/s]
Build Planet:  19%|█▉        | 5/26 [00:00&lt;00:03,  6.29it/s]
Build Planet:  23%|██▎       | 6/26 [00:00&lt;00:03,  6.37it/s]
Build Planet:  27%|██▋       | 7/26 [00:01&lt;00:02,  6.42it/s]
Build Planet:  31%|███       | 8/26 [00:01&lt;00:02,  6.40it/s]
Build Planet:  35%|███▍      | 9/26 [00:01&lt;00:02,  6.15it/s]
Build Planet:  38%|███▊      | 10/26 [00:01&lt;00:02,  6.03it/s]
Build Planet:  42%|████▏     | 11/26 [00:01&lt;00:02,  5.60it/s]
Build Planet:  46%|████▌     | 12/26 [00:02&lt;00:02,  5.20it/s]
Build Planet:  50%|█████     | 13/26 [00:02&lt;00:02,  5.12it/s]
Build Planet:  54%|█████▍    | 14/26 [00:02&lt;00:02,  5.03it/s]
Build Planet:  58%|█████▊    | 15/26 [00:02&lt;00:02,  5.01it/s]
Build Planet:  62%|██████▏   | 16/26 [00:02&lt;00:02,  4.91it/s]
Build Planet:  65%|██████▌   | 17/26 [00:03&lt;00:01,  4.72it/s]
Build Planet:  69%|██████▉   | 18/26 [00:03&lt;00:01,  4.87it/s]
Build Planet:  73%|███████▎  | 19/26 [00:03&lt;00:01,  5.19it/s]
Build Planet:  77%|███████▋  | 20/26 [00:03&lt;00:01,  5.47it/s]
Build Planet:  81%|████████  | 21/26 [00:03&lt;00:00,  5.63it/s]
Build Planet:  85%|████████▍ | 22/26 [00:03&lt;00:00,  5.73it/s]
Build Planet:  88%|████████▊ | 23/26 [00:04&lt;00:00,  5.94it/s]
Build Planet:  92%|█████████▏| 24/26 [00:04&lt;00:00,  5.96it/s]
Build Planet:  96%|█████████▌| 25/26 [00:04&lt;00:00,  5.98it/s]
Build Planet: 100%|██████████| 26/26 [00:04&lt;00:00,  6.15it/s]
Build Planet: 27it [00:04,  6.22it/s]
Build Planet: 27it [00:04,  5.67it/s]

Build Spectra:   0%|          | 0/26 [00:00&lt;?, ?it/s]

Loading Spectra:   0%|          | 0/12 [00:00&lt;?, ?it/s]

Loading Spectra:   8%|▊         | 1/12 [00:00&lt;00:03,  3.45it/s]

Loading Spectra:  17%|█▋        | 2/12 [00:00&lt;00:02,  3.45it/s]

Loading Spectra:  25%|██▌       | 3/12 [00:00&lt;00:02,  3.45it/s]

Loading Spectra:  33%|███▎      | 4/12 [00:01&lt;00:02,  3.45it/s]

Loading Spectra:  42%|████▏     | 5/12 [00:01&lt;00:02,  3.45it/s]

Loading Spectra:  50%|█████     | 6/12 [00:01&lt;00:01,  3.46it/s]

Loading Spectra:  58%|█████▊    | 7/12 [00:02&lt;00:01,  3.46it/s]

Loading Spectra:  67%|██████▋   | 8/12 [00:02&lt;00:01,  3.46it/s]

Loading Spectra:  75%|███████▌  | 9/12 [00:02&lt;00:00,  3.46it/s]

Loading Spectra:  83%|████████▎ | 10/12 [00:02&lt;00:00,  3.47it/s]

Loading Spectra:  92%|█████████▏| 11/12 [00:03&lt;00:00,  3.47it/s]

Loading Spectra: 100%|██████████| 12/12 [00:03&lt;00:00,  3.47it/s]
Loading Spectra: 100%|██████████| 12/12 [00:03&lt;00:00,  3.46it/s]

Build Spectra:   4%|▍         | 1/26 [00:03&lt;01:31,  3.66s/it]
Build Spectra:   8%|▊         | 2/26 [00:03&lt;00:38,  1.62s/it]
Build Spectra:  12%|█▏        | 3/26 [00:04&lt;00:22,  1.03it/s]
Build Spectra:  15%|█▌        | 4/26 [00:04&lt;00:14,  1.51it/s]
Build Spectra:  19%|█▉        | 5/26 [00:04&lt;00:10,  2.03it/s]
Build Spectra:  23%|██▎       | 6/26 [00:04&lt;00:07,  2.56it/s]
Build Spectra:  27%|██▋       | 7/26 [00:04&lt;00:06,  3.07it/s]
Build Spectra:  31%|███       | 8/26 [00:05&lt;00:05,  3.53it/s]
Build Spectra:  35%|███▍      | 9/26 [00:05&lt;00:04,  3.93it/s]
Build Spectra:  38%|███▊      | 10/26 [00:05&lt;00:03,  4.25it/s]
Build Spectra:  42%|████▏     | 11/26 [00:05&lt;00:03,  4.10it/s]
Build Spectra:  46%|████▌     | 12/26 [00:05&lt;00:03,  4.01it/s]
Build Spectra:  50%|█████     | 13/26 [00:06&lt;00:03,  3.94it/s]
Build Spectra:  54%|█████▍    | 14/26 [00:06&lt;00:03,  3.90it/s]
Build Spectra:  58%|█████▊    | 15/26 [00:06&lt;00:02,  3.87it/s]
Build Spectra:  62%|██████▏   | 16/26 [00:06&lt;00:02,  3.86it/s]
Build Spectra:  65%|██████▌   | 17/26 [00:07&lt;00:02,  3.84it/s]
Build Spectra:  69%|██████▉   | 18/26 [00:07&lt;00:02,  3.89it/s]
Build Spectra:  73%|███████▎  | 19/26 [00:07&lt;00:01,  4.22it/s]
Build Spectra:  77%|███████▋  | 20/26 [00:07&lt;00:01,  4.47it/s]
Build Spectra:  81%|████████  | 21/26 [00:08&lt;00:01,  4.67it/s]
Build Spectra:  85%|████████▍ | 22/26 [00:08&lt;00:00,  4.82it/s]
Build Spectra:  88%|████████▊ | 23/26 [00:08&lt;00:00,  4.92it/s]
Build Spectra:  92%|█████████▏| 24/26 [00:08&lt;00:00,  5.01it/s]
Build Spectra:  96%|█████████▌| 25/26 [00:08&lt;00:00,  5.07it/s]
Build Spectra: 100%|██████████| 26/26 [00:09&lt;00:00,  5.11it/s]
Build Spectra: 100%|██████████| 26/26 [00:09&lt;00:00,  2.88it/s]
</pre></div>
</div>
</section>
<section id="spotted-star-co2-planet">
<h3>Spotted Star, CO2 Planet<a class="headerlink" href="#spotted-star-co2-planet" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">model_rock_spotted</span> <span class="o">=</span> <span class="n">ObservationModel</span><span class="p">(</span><span class="n">params_rock_spotted</span><span class="p">)</span>
<span class="n">model_rock_spotted</span><span class="o">.</span><span class="n">build_planet</span><span class="p">()</span>
<span class="n">model_rock_spotted</span><span class="o">.</span><span class="n">build_spectra</span><span class="p">()</span>

<span class="n">data_rock_spotted</span> <span class="o">=</span> <span class="n">PhaseAnalyzer</span><span class="p">(</span><span class="n">model_rock_spotted</span><span class="o">.</span><span class="n">directories</span><span class="p">[</span><span class="s1">&#39;all_model&#39;</span><span class="p">])</span>

<span class="n">plot_transit</span><span class="p">(</span><span class="n">data_rock_spotted</span><span class="p">,</span><span class="s1">&#39;Spotted Star and Bare Rock&#39;</span><span class="p">,</span><span class="s1">&#39;xkcd:golden yellow&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_spotted_transit_003.png" srcset="../../_images/sphx_glr_plot_spotted_transit_003.png" alt="Spotted Star and Bare Rock" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Starting at phase 161.9544290544939 deg, observe for 3.53 h in 26 steps
Phases = [161.95 163.32 164.68 166.04 167.41 168.77 170.13 171.5  172.86 174.22
 175.59 176.95 178.31 179.68 181.04 182.4  183.77 185.13 186.49 187.86
 189.22 190.58 191.95 193.31 194.67 196.03 197.4 ] deg

Build Planet:   0%|          | 0/26 [00:00&lt;?, ?it/s]
Build Planet:   8%|▊         | 2/26 [00:00&lt;00:02, 10.05it/s]
Build Planet:  15%|█▌        | 4/26 [00:00&lt;00:02, 10.11it/s]
Build Planet:  23%|██▎       | 6/26 [00:00&lt;00:02,  9.81it/s]
Build Planet:  27%|██▋       | 7/26 [00:00&lt;00:01,  9.64it/s]
Build Planet:  31%|███       | 8/26 [00:00&lt;00:01,  9.37it/s]
Build Planet:  38%|███▊      | 10/26 [00:01&lt;00:01,  9.34it/s]
Build Planet:  42%|████▏     | 11/26 [00:01&lt;00:01,  8.85it/s]
Build Planet:  46%|████▌     | 12/26 [00:01&lt;00:01,  8.66it/s]
Build Planet:  50%|█████     | 13/26 [00:01&lt;00:01,  8.42it/s]
Build Planet:  54%|█████▍    | 14/26 [00:01&lt;00:01,  6.63it/s]
Build Planet:  58%|█████▊    | 15/26 [00:01&lt;00:01,  7.25it/s]
Build Planet:  62%|██████▏   | 16/26 [00:01&lt;00:01,  7.60it/s]
Build Planet:  65%|██████▌   | 17/26 [00:02&lt;00:01,  7.78it/s]
Build Planet:  69%|██████▉   | 18/26 [00:02&lt;00:00,  8.10it/s]
Build Planet:  73%|███████▎  | 19/26 [00:02&lt;00:00,  8.24it/s]
Build Planet:  77%|███████▋  | 20/26 [00:02&lt;00:00,  8.55it/s]
Build Planet:  81%|████████  | 21/26 [00:02&lt;00:00,  8.38it/s]
Build Planet:  88%|████████▊ | 23/26 [00:02&lt;00:00,  9.16it/s]
Build Planet:  92%|█████████▏| 24/26 [00:02&lt;00:00,  9.15it/s]
Build Planet:  96%|█████████▌| 25/26 [00:02&lt;00:00,  9.17it/s]
Build Planet: 100%|██████████| 26/26 [00:02&lt;00:00,  9.06it/s]
Build Planet: 27it [00:03,  9.11it/s]
Build Planet: 27it [00:03,  8.71it/s]
Generated 94 mature spots

Build Spectra:   0%|          | 0/26 [00:00&lt;?, ?it/s]

Loading Spectra:   0%|          | 0/12 [00:00&lt;?, ?it/s]

Loading Spectra:   8%|▊         | 1/12 [00:00&lt;00:03,  3.42it/s]

Loading Spectra:  17%|█▋        | 2/12 [00:00&lt;00:02,  3.43it/s]

Loading Spectra:  25%|██▌       | 3/12 [00:00&lt;00:02,  3.43it/s]

Loading Spectra:  33%|███▎      | 4/12 [00:01&lt;00:02,  3.43it/s]

Loading Spectra:  42%|████▏     | 5/12 [00:01&lt;00:02,  3.44it/s]

Loading Spectra:  50%|█████     | 6/12 [00:01&lt;00:01,  3.44it/s]

Loading Spectra:  58%|█████▊    | 7/12 [00:02&lt;00:01,  3.44it/s]

Loading Spectra:  67%|██████▋   | 8/12 [00:02&lt;00:01,  3.45it/s]

Loading Spectra:  75%|███████▌  | 9/12 [00:02&lt;00:00,  3.45it/s]

Loading Spectra:  83%|████████▎ | 10/12 [00:02&lt;00:00,  3.45it/s]

Loading Spectra:  92%|█████████▏| 11/12 [00:03&lt;00:00,  3.45it/s]

Loading Spectra: 100%|██████████| 12/12 [00:03&lt;00:00,  3.46it/s]
Loading Spectra: 100%|██████████| 12/12 [00:03&lt;00:00,  3.44it/s]

Build Spectra:   4%|▍         | 1/26 [00:03&lt;01:34,  3.76s/it]
Build Spectra:   8%|▊         | 2/26 [00:04&lt;00:41,  1.71s/it]
Build Spectra:  12%|█▏        | 3/26 [00:04&lt;00:24,  1.06s/it]
Build Spectra:  15%|█▌        | 4/26 [00:04&lt;00:16,  1.33it/s]
Build Spectra:  19%|█▉        | 5/26 [00:04&lt;00:12,  1.72it/s]
Build Spectra:  23%|██▎       | 6/26 [00:05&lt;00:09,  2.09it/s]
Build Spectra:  27%|██▋       | 7/26 [00:05&lt;00:07,  2.41it/s]
Build Spectra:  31%|███       | 8/26 [00:05&lt;00:06,  2.69it/s]
Build Spectra:  35%|███▍      | 9/26 [00:06&lt;00:05,  2.92it/s]
Build Spectra:  38%|███▊      | 10/26 [00:06&lt;00:05,  3.09it/s]
Build Spectra:  42%|████▏     | 11/26 [00:06&lt;00:05,  3.00it/s]
Build Spectra:  46%|████▌     | 12/26 [00:06&lt;00:04,  2.93it/s]
Build Spectra:  50%|█████     | 13/26 [00:07&lt;00:04,  2.91it/s]
Build Spectra:  54%|█████▍    | 14/26 [00:07&lt;00:04,  2.89it/s]
Build Spectra:  58%|█████▊    | 15/26 [00:08&lt;00:03,  2.86it/s]
Build Spectra:  62%|██████▏   | 16/26 [00:08&lt;00:03,  2.83it/s]
Build Spectra:  65%|██████▌   | 17/26 [00:08&lt;00:03,  2.81it/s]
Build Spectra:  69%|██████▉   | 18/26 [00:09&lt;00:02,  2.85it/s]
Build Spectra:  73%|███████▎  | 19/26 [00:09&lt;00:02,  3.04it/s]
Build Spectra:  77%|███████▋  | 20/26 [00:09&lt;00:01,  3.18it/s]
Build Spectra:  81%|████████  | 21/26 [00:09&lt;00:01,  3.28it/s]
Build Spectra:  85%|████████▍ | 22/26 [00:10&lt;00:01,  3.37it/s]
Build Spectra:  88%|████████▊ | 23/26 [00:10&lt;00:00,  3.43it/s]
Build Spectra:  92%|█████████▏| 24/26 [00:10&lt;00:00,  3.47it/s]
Build Spectra:  96%|█████████▌| 25/26 [00:11&lt;00:00,  3.46it/s]
Build Spectra: 100%|██████████| 26/26 [00:11&lt;00:00,  3.45it/s]
Build Spectra: 100%|██████████| 26/26 [00:11&lt;00:00,  2.28it/s]
/home/ted/github/VSPEC/VSPEC/analysis.py:115: RuntimeWarning: No Layer info, maybe globes or molecular signatures are off
  warnings.warn(
</pre></div>
</div>
</section>
</section>
<section id="plot-the-observed-spectra">
<h2>Plot the observed spectra<a class="headerlink" href="#plot-the-observed-spectra" title="Link to this heading">#</a></h2>
<p>Let’s compare the transits. We also load in the actual JWST data.</p>
<section id="get-the-data">
<h3>Get the data<a class="headerlink" href="#get-the-data" title="Link to this heading">#</a></h3>
<p>Reduced data from <span id="id3">Moran <em>et al.</em> [<a class="reference internal" href="../../references.html#id13" title="Sarah E. Moran, Kevin B. Stevenson, David K. Sing, Ryan J. MacDonald, James Kirk, Jacob Lustig-Yaeger, Sarah Peacock, L. C. Mayorga, Katherine A. Bennett, Mercedes López-Morales, E. M. May, Zafar Rustamkulov, Jeff A. Valenti, Jéa I. Adams Redai, Munazza K. Alam, Natasha E. Batalha, Guangwei Fu, Junellie Gonzalez-Quiles, Alicia N. Highland, Ethan Kruse, Joshua D. Lothringer, Kevin N. Ortiz Ceballos, Kristin S. Sotzen, and Hannah R. Wakeford. High Tide or Riptide on the Cosmic Shoreline? A Water-rich Atmosphere or Stellar Contamination for the Warm Super-Earth GJ 486b from JWST Observations. \apjl , 948(1):L11, May 2023. arXiv:2305.00868, doi:10.3847/2041-8213/accb9c.">2023</a>]</span> is publicly available.
However, you must download it from the figure caption of the online version.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="k">try</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="pathlib.Path" class="sphx-glr-backref-module-pathlib sphx-glr-backref-type-py-class"><span class="n">Path</span></a><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;moran2023_fig3.txt&#39;</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a> <span class="o">=</span> <span class="s1">&#39;moran2023_fig3.txt&#39;</span>

<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">df</span></a> <span class="o">=</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_fwf.html#pandas.read_fwf" title="pandas.read_fwf" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-function"><span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span></a><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">filename</span></a><span class="p">,</span><span class="n">colspecs</span><span class="o">=</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">),(</span><span class="mi">9</span><span class="p">,</span><span class="mi">14</span><span class="p">),(</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">),(</span><span class="mi">21</span><span class="p">,</span><span class="mi">25</span><span class="p">),(</span><span class="mi">26</span><span class="p">,</span><span class="mi">28</span><span class="p">)],</span>
    <span class="n">header</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Reduction&#39;</span><span class="p">,</span><span class="s1">&#39;Wave&#39;</span><span class="p">,</span><span class="s1">&#39;Width&#39;</span><span class="p">,</span><span class="s1">&#39;Depth&#39;</span><span class="p">,</span><span class="s1">&#39;e_Depth&#39;</span><span class="p">])</span>
<a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">used_eureka</span></a> <span class="o">=</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="pandas.core.frame.DataFrame" class="sphx-glr-backref-module-pandas-core-frame sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">df</span></a><span class="p">[</span><span class="s1">&#39;Reduction&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Eureka&#39;</span>
<a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_x</span></a> <span class="o">=</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html#pandas.DataFrame.loc" title="pandas.DataFrame.loc" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"><span class="n">df</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">used_eureka</span></a><span class="p">,</span><span class="s1">&#39;Wave&#39;</span><span class="p">]</span>
<a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_y</span></a> <span class="o">=</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html#pandas.DataFrame.loc" title="pandas.DataFrame.loc" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"><span class="n">df</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">used_eureka</span></a><span class="p">,</span><span class="s1">&#39;Depth&#39;</span><span class="p">]</span>
<a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_yerr</span></a> <span class="o">=</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.loc.html#pandas.DataFrame.loc" title="pandas.DataFrame.loc" class="sphx-glr-backref-module-pandas sphx-glr-backref-type-py-property"><span class="n">df</span><span class="o">.</span><span class="n">loc</span></a><span class="p">[</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">used_eureka</span></a><span class="p">,</span><span class="s1">&#39;e_Depth&#39;</span><span class="p">]</span>
<a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">moran_mean</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_y</span></a><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/ted/github/VSPEC/examples/end_to_end/plot_spotted_transit.py:353: DeprecationWarning:
Pyarrow will become a required dependency of pandas in the next major release of pandas (pandas 3.0),
(to allow more performant data types, such as the Arrow string type, and better interoperability with other libraries)
but was not found to be installed on your system.
If this would cause problems for you,
please provide us feedback at https://github.com/pandas-dev/pandas/issues/54466

  import pandas as pd
</pre></div>
</div>
</section>
<section id="make-the-figure">
<h3>Make the figure<a class="headerlink" href="#make-the-figure" title="Link to this heading">#</a></h3>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">data</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[</span><span class="n">data_rock_quiet</span><span class="p">,</span><span class="n">data_h2o_quiet</span><span class="p">,</span><span class="n">data_rock_spotted</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;Rock&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;Rock+Spots&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;xkcd:lavender&#39;</span><span class="p">,</span><span class="s1">&#39;xkcd:azure&#39;</span><span class="p">,</span><span class="s1">&#39;xkcd:golden yellow&#39;</span><span class="p">]</span>
<span class="p">):</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pre_transit</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PRE_TRANSIT</span></a>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_transit</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">IN_TRANSIT</span></a>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pre_transit</span></a><span class="p">)</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">occulted_spectrum</span></a> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_transit</span></a><span class="p">)</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lost_to_transit</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a><span class="o">-</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">occulted_spectrum</span></a>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a> <span class="o">=</span> <span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lost_to_transit</span></a><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a><span class="p">)</span><span class="o">.</span><span class="n">to_value</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.CompositeUnit.html#astropy.units.CompositeUnit" title="astropy.units.CompositeUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">dimensionless_unscaled</span></a><span class="p">)</span><span class="o">*</span><span class="mf">1e6</span>
    <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">depth_mean</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.mean.html#numpy.mean" title="numpy.mean" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">mean</span></a><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a><span class="p">)</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">shift</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">moran_mean</span></a><span class="o">/</span><a href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="numpy.float64" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-attribute"><span class="n">depth_mean</span></a>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">shift</span></a> <span class="o">=</span> <span class="mi">1</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">wavelength</span></a><span class="p">,</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a><span class="o">*</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">shift</span></a><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html#matplotlib.axes.Axes.errorbar" title="matplotlib.axes.Axes.errorbar" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span></a><span class="p">(</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_x</span></a><span class="p">,</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_y</span></a><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_yerr</span></a><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="o">=</span><span class="s1">&#39;Moran+23 Eureka!&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s1">&#39;Wavelength (um)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s1">&#39;Transit depth (ppm)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="matplotlib.axes.Axes.legend" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_spotted_transit_004.png" srcset="../../_images/sphx_glr_plot_spotted_transit_004.png" alt="plot spotted transit" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f8c6c55d490&gt;
</pre></div>
</div>
</section>
<section id="make-the-figure-again">
<h3>Make the figure again<a class="headerlink" href="#make-the-figure-again" title="Link to this heading">#</a></h3>
<p>This time without the bare rock</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.html#matplotlib.axes.Axes" title="matplotlib.axes.Axes" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">ax</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">3.5</span><span class="p">),</span><span class="n">tight_layout</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">for</span> <span class="n">data</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
    <span class="p">[</span><span class="n">data_h2o_quiet</span><span class="p">,</span><span class="n">data_rock_spotted</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;Rock+Spots&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;xkcd:azure&#39;</span><span class="p">,</span><span class="s1">&#39;xkcd:golden yellow&#39;</span><span class="p">]</span>
<span class="p">):</span>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pre_transit</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">PRE_TRANSIT</span></a>
    <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_transit</span></a> <span class="o">=</span> <a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">IN_TRANSIT</span></a>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pre_transit</span></a><span class="p">)</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">occulted_spectrum</span></a> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="s1">&#39;total&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/functions.html#int" title="builtins.int" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">in_transit</span></a><span class="p">)</span>
    <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lost_to_transit</span></a> <span class="o">=</span> <a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a><span class="o">-</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">occulted_spectrum</span></a>
    <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a> <span class="o">=</span> <span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">lost_to_transit</span></a><span class="o">/</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">unocculted_spectrum</span></a><span class="p">)</span><span class="o">.</span><span class="n">to_value</span><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.CompositeUnit.html#astropy.units.CompositeUnit" title="astropy.units.CompositeUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">dimensionless_unscaled</span></a><span class="p">)</span>
    <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="matplotlib.axes.Axes.plot" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">plot</span></a><span class="p">(</span><a href="https://docs.astropy.org/en/stable/api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">data</span><span class="o">.</span><span class="n">wavelength</span></a><span class="p">,</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">transit_depth</span></a><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.errorbar.html#matplotlib.axes.Axes.errorbar" title="matplotlib.axes.Axes.errorbar" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span></a><span class="p">(</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_x</span></a><span class="p">,</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_y</span></a><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.html#pandas.Series" title="pandas.core.series.Series" class="sphx-glr-backref-module-pandas-core-series sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">moran_yerr</span></a><span class="p">,</span>
    <span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">color</span></a><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">label</span></a><span class="o">=</span><span class="s1">&#39;Moran+23 Eureka!&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_xlabel.html#matplotlib.axes.Axes.set_xlabel" title="matplotlib.axes.Axes.set_xlabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span></a><span class="p">(</span><span class="s1">&#39;Wavelength (um)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.set_ylabel.html#matplotlib.axes.Axes.set_ylabel" title="matplotlib.axes.Axes.set_ylabel" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span></a><span class="p">(</span><span class="s1">&#39;Transit depth (ppm)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html#matplotlib.axes.Axes.legend" title="matplotlib.axes.Axes.legend" class="sphx-glr-backref-module-matplotlib-axes sphx-glr-backref-type-py-method"><span class="n">ax</span><span class="o">.</span><span class="n">legend</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../_images/sphx_glr_plot_spotted_transit_005.png" srcset="../../_images/sphx_glr_plot_spotted_transit_005.png" alt="plot spotted transit" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f8c8c3fd0d0&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 49.795 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-end-to-end-plot-spotted-transit-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c8751aa4ba74469278915768f17e5331/plot_spotted_transit.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_spotted_transit.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/e4711081c098b98a182b016f9787c9ac/plot_spotted_transit.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_spotted_transit.py</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_gj1214b_kempton23.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Observe a phase curve of a spotted star.</p>
      </div>
    </a>
    <a class="right-next"
       href="../other/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Other Examples</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-the-needed-configurations">Create the needed configurations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-vspec-for-the-simplest-case">Run VSPEC for the simplest case</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-in-the-data">Load in the data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-transit">Plot the transit</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-other-models">Run the other models</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spotless-star-h2o-planet">Spotless Star, H2O Planet</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spotted-star-co2-planet">Spotted Star, CO2 Planet</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-observed-spectra">Plot the observed spectra</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#get-the-data">Get the data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-the-figure">Make the figure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#make-the-figure-again">Make the figure again</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/auto_examples/end_to_end/plot_spotted_transit.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, The VSPEC Collaboration.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.2.6.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>